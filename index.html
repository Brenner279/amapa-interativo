<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>VR Simples com Navegação e Vídeo</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@^3.0.3/dist/aframe-event-set-component.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        #infoPanel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
            max-width: 300px;
        }
        #instructions {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-align: center;
            z-index: 1000;
            font-size: 14px;
        }
        .video-controls {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }
        .video-controls button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .video-controls button:hover {
            background: #2c75f2;
        }
    </style>
</head>
<body>
    <div id="infoPanel">
        <h3>Navegação VR com Vídeo</h3>
        <p>Use o cursor para navegar e interagir:</p>
        <ul>
            <li>Olhe para os pontos coloridos para navegar</li>
            <li>Olhe para a tela de vídeo para reproduzir</li>
            <li>Use os controles para gerenciar o vídeo</li>
        </ul>
        <p>Posição atual: <span id="currentPosition">Central</span></p>
    </div>
    
    <div id="instructions">
        Mova seu cursor (ou visor em VR) sobre os pontos coloridos para navegar pela cena.
        Olhe para a tela de vídeo para iniciar a reprodução.
    </div>
    
    <div class="video-controls" id="videoControls" style="display: none;">
        <button id="playBtn">Reproduzir</button>
        <button id="pauseBtn">Pausar</button>
        <button id="stopBtn">Parar</button>
        <button id="muteBtn">Silenciar</button>
    </div>

    <a-scene cursor="rayOrigin: mouse" raycaster="objects: .clickable" loading-screen="dotsColor: #0080e5; backgroundColor: #000">
        
        <!-- Câmera com cursor de gaze -->
        <a-camera position="0 1.6 0">
            <a-cursor 
                id="cursor"
                fuse="true" 
                fuse-timeout="1000"
                animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                animation__fusing="property: scale; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
                animation__mouseleave="property: scale; startEvents: mouseleave; from: 0.1 0.1 0.1; to: 1 1 1; dur: 500"
                raycaster="far: 20; interval: 100">
            </a-cursor>
        </a-camera>
        
        <!-- Cenário básico -->
        <a-box id="floor" position="0 -0.5 0" width="30" height="0.1" depth="30" color="#7BC8A4"></a-box>
        
        <!-- Céu -->
        <a-sky color="#87CEEB"></a-sky>
        
        <!-- Luz -->
        <a-light type="ambient" color="#888"></a-light>
        <a-light type="directional" intensity="0.6" position="-1 2 1"></a-light>
        
        <!-- Posição Central (ponto de partida) -->
        <a-entity id="centerPosition">
            <!-- Tela de vídeo central -->
            <a-video 
                id="videoScreen"
                src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                width="4" 
                height="2.25"
                position="0 2 -3"
                rotation="0 0 0"
                class="clickable"
                visible="true">
            </a-video>
            
            <!-- Moldura da tela -->
            <a-box 
                width="4.2" 
                height="2.45" 
                depth="0.1" 
                position="0 2 -2.95"
                color="#333">
            </a-box>
            
            <!-- Texto informativo -->
            <a-text 
                value="Olhe para a tela para reproduzir o vídeo" 
                position="0 1 -3" 
                color="#FFF" 
                align="center" 
                width="5">
            </a-text>
            
            <!-- Pontos de navegação a partir do centro -->
            <!-- Ponto para posição esquerda -->
            <a-ring 
                id="navLeft"
                class="clickable"
                position="-5 1.5 -3"
                radius-inner="0.2"
                radius-outer="0.25"
                color="#4285f4"
                rotation="-90 0 0"
                event-set__mouseenter="_event: mouseenter; color: #2c75f2"
                event-set__mouseleave="_event: mouseleave; color: #4285f4">
            </a-ring>
            
            <!-- Ponto para posição direita -->
            <a-ring 
                id="navRight"
                class="clickable"
                position="5 1.5 -3"
                radius-inner="0.2"
                radius-outer="0.25"
                color="#4285f4"
                rotation="-90 0 0"
                event-set__mouseenter="_event: mouseenter; color: #2c75f2"
                event-set__mouseleave="_event: mouseleave; color: #4285f4">
            </a-ring>
        </a-entity>
        
        <!-- Posição Esquerda (apenas navegação de volta) -->
        <a-entity id="leftPosition" visible="false">
            <a-text 
                value="Posição Esquerda\nOlhe para o ponto azul para retornar" 
                position="0 2.5 -3" 
                color="#FFF" 
                align="center" 
                width="6">
            </a-text>
            
            <!-- Ponto para retornar ao centro -->
            <a-ring 
                id="navToCenterFromLeft"
                class="clickable"
                position="0 1.5 -3"
                radius-inner="0.2"
                radius-outer="0.25"
                color="#4285f4"
                rotation="-90 0 0"
                event-set__mouseenter="_event: mouseenter; color: #2c75f2"
                event-set__mouseleave="_event: mouseleave; color: #4285f4">
            </a-ring>
            
            <!-- Objeto decorativo -->
            <a-box 
                position="-2 1 -4"
                width="1"
                height="2"
                depth="1"
                color="#EA4335">
            </a-box>
            
            <a-sphere
                position="2 1.5 -4"
                radius="0.8"
                color="#34A853">
            </a-sphere>
        </a-entity>
        
        <!-- Posição Direita (outro vídeo) -->
        <a-entity id="rightPosition" visible="false">
            <!-- Segunda tela de vídeo -->
            <a-video 
                id="videoScreen2"
                src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4"
                width="4" 
                height="2.25"
                position="0 2 -3"
                rotation="0 0 0"
                class="clickable"
                visible="true">
            </a-video>
            
            <!-- Moldura da tela -->
            <a-box 
                width="4.2" 
                height="2.45" 
                depth="0.1" 
                position="0 2 -2.95"
                color="#333">
            </a-box>
            
            <a-text 
                value="Segundo vídeo\nOlhe para a tela para reproduzir" 
                position="0 1 -3" 
                color="#FFF" 
                align="center" 
                width="5">
            </a-text>
            
            <!-- Ponto para retornar ao centro -->
            <a-ring 
                id="navToCenterFromRight"
                class="clickable"
                position="0 1.5 0"
                radius-inner="0.2"
                radius-outer="0.25"
                color="#4285f4"
                rotation="-90 0 0"
                event-set__mouseenter="_event: mouseenter; color: #2c75f2"
                event-set__mouseleave="_event: mouseleave; color: #4285f2">
            </a-ring>
            
            <!-- Objeto decorativo -->
            <a-torus
                position="-2 1 -4"
                arc="360"
                radius="0.8"
                radius-tubular="0.1"
                color="#FBBC05">
            </a-torus>
            
            <a-cylinder
                position="2 1 -4"
                radius="0.6"
                height="1.5"
                color="#EA4335">
            </a-cylinder>
        </a-entity>
        
        <!-- Elementos de navegação (teleportadores) -->
        <a-text 
            value="NAVEGAÇÃO VR COM VÍDEO"
            position="0 4 -6"
            color="#FFF"
            align="center"
            width="8"
            scale="2 2 2">
        </a-text>
        
    </a-scene>

    <script>
        // Aguardar o carregamento da cena
        document.addEventListener('DOMContentLoaded', function() {
            // Referências aos elementos importantes
            const cursor = document.querySelector('#cursor');
            const centerPosition = document.querySelector('#centerPosition');
            const leftPosition = document.querySelector('#leftPosition');
            const rightPosition = document.querySelector('#rightPosition');
            const videoScreen = document.querySelector('#videoScreen');
            const videoScreen2 = document.querySelector('#videoScreen2');
            const currentPositionElement = document.getElementById('currentPosition');
            const videoControls = document.getElementById('videoControls');
            const playBtn = document.getElementById('playBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const stopBtn = document.getElementById('stopBtn');
            const muteBtn = document.getElementById('muteBtn');
            
            // Estado do aplicativo
            let currentPosition = 'center';
            let currentVideo = videoScreen;
            let isMuted = false;
            
            // Função para navegar entre posições
            function navigateTo(position) {
                // Esconder todas as posições
                centerPosition.setAttribute('visible', 'false');
                leftPosition.setAttribute('visible', 'false');
                rightPosition.setAttribute('visible', 'false');
                
                // Mostrar a posição atual
                if (position === 'center') {
                    centerPosition.setAttribute('visible', 'true');
                    currentPosition = 'center';
                    currentPositionElement.textContent = 'Central';
                    currentVideo = videoScreen;
                    videoControls.style.display = 'flex';
                } else if (position === 'left') {
                    leftPosition.setAttribute('visible', 'true');
                    currentPosition = 'left';
                    currentPositionElement.textContent = 'Esquerda';
                    videoControls.style.display = 'none';
                } else if (position === 'right') {
                    rightPosition.setAttribute('visible', 'true');
                    currentPosition = 'right';
                    currentPositionElement.textContent = 'Direita';
                    currentVideo = videoScreen2;
                    videoControls.style.display = 'flex';
                }
                
                // Parar qualquer vídeo que esteja tocando ao navegar
                stopAllVideos();
            }
            
            // Função para parar todos os vídeos
            function stopAllVideos() {
                if (videoScreen.getAttribute('src')) {
                    videoScreen.pause();
                    videoScreen.currentTime = 0;
                }
                if (videoScreen2.getAttribute('src')) {
                    videoScreen2.pause();
                    videoScreen2.currentTime = 0;
                }
            }
            
            // Configurar navegação ao clicar nos pontos
            document.querySelector('#navLeft').addEventListener('click', function() {
                navigateTo('left');
            });
            
            document.querySelector('#navRight').addEventListener('click', function() {
                navigateTo('right');
            });
            
            document.querySelector('#navToCenterFromLeft').addEventListener('click', function() {
                navigateTo('center');
            });
            
            document.querySelector('#navToCenterFromRight').addEventListener('click', function() {
                navigateTo('center');
            });
            
            // Configurar eventos de vídeo
            videoScreen.addEventListener('click', function() {
                if (videoScreen.getAttribute('src')) {
                    if (videoScreen.paused) {
                        videoScreen.play();
                    } else {
                        videoScreen.pause();
                    }
                }
            });
            
            videoScreen2.addEventListener('click', function() {
                if (videoScreen2.getAttribute('src')) {
                    if (videoScreen2.paused) {
                        videoScreen2.play();
                    } else {
                        videoScreen2.pause();
                    }
                }
            });
            
            // Configurar controles de vídeo
            playBtn.addEventListener('click', function() {
                if (currentVideo.getAttribute('src')) {
                    currentVideo.play();
                }
            });
            
            pauseBtn.addEventListener('click', function() {
                if (currentVideo.getAttribute('src')) {
                    currentVideo.pause();
                }
            });
            
            stopBtn.addEventListener('click', function() {
                if (currentVideo.getAttribute('src')) {
                    currentVideo.pause();
                    currentVideo.currentTime = 0;
                }
            });
            
            muteBtn.addEventListener('click', function() {
                if (currentVideo.getAttribute('src')) {
                    isMuted = !isMuted;
                    currentVideo.muted = isMuted;
                    muteBtn.textContent = isMuted ? "Ativar som" : "Silenciar";
                }
            });
            
            // Configurar eventos de gaze (fuse) para os vídeos
            videoScreen.addEventListener('fusing', function() {
                if (videoScreen.getAttribute('src') && videoScreen.paused) {
                    videoScreen.play();
                }
            });
            
            videoScreen2.addEventListener('fusing', function() {
                if (videoScreen2.getAttribute('src') && videoScreen2.paused) {
                    videoScreen2.play();
                }
            });
            
            // Configurar eventos de gaze para navegação
            const navElements = document.querySelectorAll('.clickable');
            navElements.forEach(function(el) {
                el.addEventListener('fusing', function() {
                    // O clique já é acionado pelo componente fuse, então não precisamos fazer nada extra
                });
            });
            
            // Inicializar na posição central
            navigateTo('center');
            
            // Log para depuração
            console.log('Cena VR carregada. Use o cursor para navegar e interagir com os vídeos.');
        });
    </script>
</body>
</html>
